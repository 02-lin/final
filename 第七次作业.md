#第六次作业--直线检测
####姓名：林袁钰
####班级：自动化66班 
####学号：21606504138

##摘要
点，线，边缘检测主要以灰度局部剧烈变化检测为基础。三种重要的图像特征为孤立点，线和边缘。一条线可视为一条边缘线段，该线两侧的背景灰度要么远亮于该线的像素的灰度，要么远暗于。孤立点可视为一条线，只是其长度和宽度都为一个像素。本次作业主要基于孤立点，线以及边缘检测，完成以下任务：  

1. 首先对测试图像（文件名为：test1~test6）进行边缘检测，可采用书上介绍的Sobel等模板或者cann算子方法；  
2. 在边缘检测的基础上，用hough变换检测图中直线；  
3. 比较不同边缘检测算法（2种以上）、不同hough变换参数对直线检测的影响；  

***
##关键词
matlab; 边缘检测，梯度算子，hough变换等。

##作业内容
###1. 首先对测试图像（文件名为：test1~test6）进行边缘检测，可采用书上介绍的Sobel等模板或者cann算子方法；    
* **边缘检测有关知识**  
边缘检测是基于灰度图便来分割图像的常用方法。边缘模型根据他们的灰度剖面来分类。共有三种类型边缘，分别为台阶模型、斜坡模型以及屋顶边缘模型。  
边缘检测的三个基本步骤为：  
 1.为降噪对图像进行平滑处理。  
 2.边缘点的检测。这是一个局部操作，从一副图像中提取所有的点，这些点是变为边缘点的潜在候选者。  
 3.边缘定位。这一步的目的是从候选边缘点中选择组成边缘点集合的真实成员。  

为达到寻找边缘的目的，检测灰度变化可以用一阶或者二阶导数来完成。而要得到一幅图像的梯度，则要求在图像上的每个像素处计算偏导数。我们处理的是数字量，因此要求关于一点的邻域上的偏导数是数字近似，由此我们可以通过选择不同的模板来完成不同的边缘选择。  

**roberts算子**  
当对对角线方向的边缘感兴趣时，一般选择roberts的二位模板。这些模板考虑了中心点两端数据的性质，并携带有关于边缘方向的更多信息。  
**prewitt算子**  
 Prewitt算子是一种一阶微分算子的边缘检测，利用像素点上下、左右邻点的灰度差，在边缘处达到极值检测边缘，去掉部分伪边缘，对噪声具有平滑作用 。其原理是在图像空间利用两个方向模板与图像进行邻域卷积来完成的，这两个方向模板一个检测水平边缘，一个检测垂直边缘。  
经典Prewitt算子认为：凡灰度新值大于或等于阈值的像素点都是边缘点。即选择适当的阈值T，若P(i,j)≥T，则(i,j)为边缘点，P(i,j)为边缘图像。这种判定是欠合理的，会造成边缘点的误判，因为许多噪声点的灰度值也很大，而且对于幅值较小的边缘点，其边缘反而丢失了。  
Prewitt算子对噪声有抑制作用，抑制噪声的原理是通过像素平均，但是像素平均相当于对图像的低通滤波，所以Prewitt算子对边缘的定位不如Roberts算子。  
因为平均能减少或消除噪声，Prewitt梯度算子法就是先求平均，再求差分来求梯度。  
**sobel算子**   
 其主要用于边缘检测，在技术上它是以离散型的差分算子，用来运算图像亮度函数的梯度的近似值， Sobel算子是典型的基于一阶导数的边缘检测算子，由于该算子中引入了类似局部平均的运算，因此对噪声具有平滑作用，能很好的消除噪声的影响。Sobel算子对于象素的位置的影响做了加权，与Prewitt算子、Roberts算子相比因此效果更好。  
 Sobel算子包含两组3x3的矩阵，分别为横向及纵向模板，将之与图像作平面卷积，即可分别得出横向及纵向的亮度差分近似值。  
**canny算子**  
该算子功能比前面几种都要好，但是它实现起来较为麻烦，Canny算子是一个具有滤波，增强，检测的多阶段的优化算子，在进行处理前，Canny算子先利用高斯平滑滤波器来平滑图像以除去噪声，Canny分割算法采用一阶偏导的有限差分来计算梯度幅值和方向，在处理过程中，Canny算子还将经过一个非极大值抑制的过程，最后Canny算子还采用两个阈值来连接边缘。    

* **调用函数说明**    
**BW = edge(I,'sobel')**     
 自动选择阈值用Sobel算子进行边缘检测    
* **实验代码**   
实验代码在附件edgeDetection中。  
* **实验结果**  
注： 以下分别为test1~test6的边缘检测结果图。每张图中分别包含原图，以及各种梯度算子作用下的边缘检测结果图。  
![q1-1](./photo/01/01.png)  
![q1-2](./photo/01/02.png)  
![q1-3](./photo/01/03.png)  
![q1-4](./photo/01/04.png)  
![q1-5](./photo/01/05.png)  
![q1-6](./photo/01/06.png)  


###2. 在边缘检测的基础上，用hough变换检测图中直线；   

* **hough变换有关知识**  

霍夫变换（Hough Transform）换于1962年由Paul Hough 首次提出，后于1972年由Richard Duda和Peter Hart推广使用，是图像处理中从图像中检测几何形状的基本方法之一。经典霍夫变换用来检测图像中的直线，后来霍夫变换经过扩展可以进行任意形状物体的识别，例如圆和椭圆。      
霍夫变换运用两个坐标空间之间的变换将在一个空间中具有相同形状的曲线或直线映射到另一个坐标空间的一个点上形成峰值，从而把检测任意形状的问题转化为统计峰值问题。   
Hough直线检测的基本原理在于利用点与线的对偶性，在我们的直线检测任务中，即图像空间中的直线与参数空间中的点是一一对应的，参数空间中的直线与图像空间中的点也是一一对应的。这意味着我们可以得出两个非常有用的结论：   
　　1）图像空间中的每条直线在参数空间中都对应着单独一个点来表示；   
　　2）图像空间中的直线上任何一部分线段在参数空间对应的是同一个点。   
因此Hough直线检测算法就是把在图像空间中的直线检测问题转换到参数空间中对点的检测问题，通过在参数空间里寻找峰值来完成直线检测任务。      
如前所述，霍夫直线检测就是把图像空间中的直线变换到参数空间中的点，通过统计特性来解决检测问题。具体来说，如果一幅图像中的像素构成一条直线，那么这些像素坐标值（x, y）在参数空间对应的曲线一定相交于一个点，所以我们只需要将图像中的所有像素点（坐标值）变换成参数空间的曲线，并在参数空间检测曲线交点就可以确定直线了。    
在理论上，一个点对应无数条直线或者说任意方向的直线，但在实际应用中，我们必须限定直线的数量（即有限数量的方向）才能够进行计算。    
因此，我们将直线的方向θ离散化为有限个等间距的离散值，参数ρ也就对应离散化为有限个值，于是参数空间不再是连续的，而是被离散量化为一个个等大小网格单元。将图像空间（直角坐标系）中每个像素点坐标值变换到参数空间（极坐标系）后，所得值会落在某个网格内，使该网格单元的累加计数器加1。当图像空间中所有的像素都经过霍夫变换后，对网格单元进行检查，累加计数值最大的网格，其坐标值（ρ0, θ0）就对应图像空间中所求的直线。   

* **调用函数说明**    
**[H,T,R] = hough(BW)**       
%计算二值图像的标准霍夫变换，H为霍夫变换矩阵，T,R为计算霍夫变换的角度和半径值   
**P = houghpeaks(H,num)**     
%提取n个极值点  
* **实验代码**    
实验代码在附件hough1中。    

* **实验结果**  

![q2-1](./photo/02/c1.png)  
![q2-2](./photo/02/c2.png)  
![q2-3](./photo/02/c3.png)  
![q2-4](./photo/02/s1.png)  
![q2-5](./photo/02/s2.png)  
![q2-6](./photo/02/s3.png)  
![q2-7](./photo/02/r1.png)  
![q2-8](./photo/02/r2.png)  
![q2-9](./photo/02/r3.png) 


###3.比较不同边缘检测算法（2种以上）、不同hough变换参数对直线检测的影响；

本次作业中主要对比了test1的在分别以canny算子，sobel算子以及roberts算子为梯度算子的边缘检测算法的基础上不同hough变换参数对直线检测的影响。  
由实验结果图发现，在hough变换参数不变的情况下，由于robert算子的边缘检测效果弱于sobel算子，sobel算子的边缘检测效果弱于canny算子，所以在直线检测中，以roberts算子为基础的直线检测结果更好，线段更贴近于图像原本就有的直线，而最为复杂的canny算子由于边缘检测结果更加精细复杂，因而在hough变换参数不变的情况下，直线检测具有更多干扰，于是实验结果较不理想。  
在边缘检测算法不变的情况下，改变hough变换参数，及改变极值点的个数，发现随着极值点的个数增加，实验结果图中的直线检测结果更多且更准确。  

###附录
【参考文献】  
[1]冈萨雷斯，数字图像处理第三版，北京，电子工业出版社，2011  
[2]周品，MATLAB数字图像处理，北京，清华大学出版社，2012  